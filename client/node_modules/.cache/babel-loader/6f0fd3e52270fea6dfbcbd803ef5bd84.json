{"ast":null,"code":"import _regeneratorRuntime from \"/home/wayne/Desktop/blockchain/development3/final-project/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/wayne/Desktop/blockchain/development3/final-project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/wayne/Desktop/blockchain/development3/final-project/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/wayne/Desktop/blockchain/development3/final-project/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/wayne/Desktop/blockchain/development3/final-project/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/wayne/Desktop/blockchain/development3/final-project/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/wayne/Desktop/blockchain/development3/final-project/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/wayne/Desktop/blockchain/development3/final-project/client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/wayne/Desktop/blockchain/development3/final-project/client/src/components/cars.js\";\nimport React, { Component } from \"react\";\nimport RentContract from \"../contracts/Rent.json\";\nimport ReturnContract from \"../contracts/Return.json\";\nimport getWeb3 from \"../utils/getWeb3\";\nimport truffleContract from \"truffle-contract\";\nimport \"./cars.css\";\n\nvar cars =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(cars, _Component);\n\n  function cars(props) {\n    var _this;\n\n    _classCallCheck(this, cars);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(cars).call(this, props));\n    _this.componentDidMount =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var data, web3, accounts, ContractRent, ContractReturn, instanceRent, instanceReturn;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              data = require('../cars.json');\n\n              _this.setState({\n                cars: data\n              }); // Get network provider and web3 instance.\n\n\n              _context.next = 5;\n              return getWeb3();\n\n            case 5:\n              web3 = _context.sent;\n              _context.next = 8;\n              return web3.eth.getAccounts();\n\n            case 8:\n              accounts = _context.sent;\n              // Get the contract instance.\n              ContractRent = truffleContract(RentContract);\n              ContractReturn = truffleContract(ReturnContract);\n              ContractRent.setProvider(web3.currentProvider);\n              ContractReturn.setProvider(web3.currentProvider);\n              _context.next = 15;\n              return ContractRent.deployed();\n\n            case 15:\n              instanceRent = _context.sent;\n              _context.next = 18;\n              return ContractReturn.deployed();\n\n            case 18:\n              instanceReturn = _context.sent;\n\n              // Set web3, accounts, and contract to the state, and then proceed with an\n              // example of interacting with the contract's methods.\n              _this.setState({\n                web3: web3,\n                accounts: accounts,\n                rentContract: instanceRent,\n                returnContract: instanceReturn\n              }, _this.markRented);\n\n              _context.next = 26;\n              break;\n\n            case 22:\n              _context.prev = 22;\n              _context.t0 = _context[\"catch\"](0);\n              // Catch any errors for any of the above operations.\n              alert(\"Failed to load web3, accounts, or contract. Check console for details.\");\n              console.log(_context.t0);\n\n            case 26:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[0, 22]]);\n    }));\n    _this.markRented =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var _this$state, cars, rentContract, rentals, i;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _this$state = _this.state, cars = _this$state.cars, rentContract = _this$state.rentContract; // Get the value from the contract to prove it worked.\n\n              _context2.next = 3;\n              return rentContract.getRentals();\n\n            case 3:\n              rentals = _context2.sent;\n\n              for (i = 0; i < rentals.length; i++) {\n                if (rentals[i] !== '0x0000000000000000000000000000000000000000') {\n                  cars[i].disabled = true;\n                }\n              }\n\n              _this.setState({\n                cars: cars\n              });\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, this);\n    }));\n\n    _this.handleRent =\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(id, e) {\n        var _this$state2, accounts, rentContract, carId;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                e.preventDefault();\n                _this$state2 = _this.state, accounts = _this$state2.accounts, rentContract = _this$state2.rentContract;\n                carId = parseInt(id);\n                _context3.next = 5;\n                return rentContract.rent(carId, {\n                  from: accounts[0]\n                });\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function (_x, _x2) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    _this.handleReturn =\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(id, e) {\n        var _this$state3, accounts, returnContract, carId;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                e.preventDefault();\n                _this$state3 = _this.state, accounts = _this$state3.accounts, returnContract = _this$state3.returnContract;\n                carId = parseInt(id);\n                _context4.next = 5;\n                return returnContract.returnCar(carId, {\n                  from: accounts[0]\n                });\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      return function (_x3, _x4) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.state = {\n      cars: [],\n      web3: null,\n      accounts: null,\n      rentContract: null,\n      returnContract: null\n    };\n    _this.handleRent = _this.handleRent.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleReturn = _this.handleReturn.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(cars, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-xs-12 col-sm-8 col-sm-push-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, \"Car Rental\"), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row\",\n        id: \"carTemplate\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, this.state.cars.map(function (car) {\n        return React.createElement(\"div\", {\n          className: \"col-md-4\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }, React.createElement(\"form\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 109\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"card rounded\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"card-image\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"card-notify-badge\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }, car.campaign), React.createElement(\"span\", {\n          className: \"card-notify-year\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113\n          },\n          __self: this\n        }, car.year), React.createElement(\"img\", {\n          className: \"img-fluid\",\n          src: car.picture,\n          alt: car.name,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        })), React.createElement(\"div\", {\n          className: \"card-image-overlay m-auto\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"card-detail-badge\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117\n          },\n          __self: this\n        }, car.seats), React.createElement(\"span\", {\n          className: \"card-detail-badge\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, car.price), React.createElement(\"span\", {\n          className: \"card-detail-badge\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, car.transmission)), React.createElement(\"div\", {\n          className: \"card-body text-center\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"ad-title m-auto\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        }, React.createElement(\"h5\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        }, car.name)), React.createElement(\"button\", {\n          className: \"ad-btn\",\n          type: \"button\",\n          disabled: car.disabled,\n          onClick: function onClick(e) {\n            return _this2.handleRent(car.id, e);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, \"Book\"), React.createElement(\"button\", {\n          className: \"ad-btn\",\n          type: \"button\",\n          onClick: function onClick(e) {\n            return _this2.handleReturn(car.id, e);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, \"Return\")))));\n      })));\n    }\n  }]);\n\n  return cars;\n}(Component);\n\nexport default cars;","map":{"version":3,"sources":["/home/wayne/Desktop/blockchain/development3/final-project/client/src/components/cars.js"],"names":["React","Component","RentContract","ReturnContract","getWeb3","truffleContract","cars","props","componentDidMount","data","require","setState","web3","eth","getAccounts","accounts","ContractRent","ContractReturn","setProvider","currentProvider","deployed","instanceRent","instanceReturn","rentContract","returnContract","markRented","alert","console","log","state","getRentals","rentals","i","length","disabled","handleRent","id","e","preventDefault","carId","parseInt","rent","from","handleReturn","returnCar","bind","map","car","campaign","year","picture","name","seats","price","transmission"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport RentContract from \"../contracts/Rent.json\";\nimport ReturnContract from \"../contracts/Return.json\";\nimport getWeb3 from \"../utils/getWeb3\";\nimport truffleContract from \"truffle-contract\";\n\nimport \"./cars.css\";\n\nclass cars extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            cars: [],\n            web3: null,\n            accounts: null,\n            rentContract: null,\n            returnContract: null\n        };\n\n        this.handleRent = this.handleRent.bind(this);\n        this.handleReturn = this.handleReturn.bind(this);\n    }\n\n    componentDidMount = async () => {\n        try {\n            var data = require('../cars.json');\n\n            this.setState({cars: data});\n\n            // Get network provider and web3 instance.\n            const web3 = await getWeb3();\n\n            // Use web3 to get the user's accounts.\n            const accounts = await web3.eth.getAccounts();\n\n            // Get the contract instance.\n            const ContractRent = truffleContract(RentContract);\n            const ContractReturn = truffleContract(ReturnContract);\n            ContractRent.setProvider(web3.currentProvider);\n            ContractReturn.setProvider(web3.currentProvider);\n            const instanceRent = await ContractRent.deployed();\n            const instanceReturn = await ContractReturn.deployed();\n\n            // Set web3, accounts, and contract to the state, and then proceed with an\n            // example of interacting with the contract's methods.\n            this.setState({ web3, accounts, rentContract: instanceRent, returnContract: instanceReturn }, this.markRented);\n\n        } catch (error) {\n            // Catch any errors for any of the above operations.\n            alert(\n                `Failed to load web3, accounts, or contract. Check console for details.`\n            );\n            console.log(error);\n        }\n    };\n\n    markRented = async () => {\n        const { cars, rentContract } = this.state;\n\n        // Get the value from the contract to prove it worked.\n        const rentals = await rentContract.getRentals();\n\n        for (let i = 0; i < rentals.length; i++) {\n            if (rentals[i] !== '0x0000000000000000000000000000000000000000') {\n                cars[i].disabled = true;\n            }\n        }\n\n        this.setState({cars: cars});\n    }\n\n    handleRent = async (id, e) => {\n        e.preventDefault();\n\n        const { accounts, rentContract } = this.state;\n\n        var carId = parseInt(id);\n\n        await rentContract.rent(carId, { from: accounts[0] })\n    }\n\n    handleReturn = async (id, e) => {\n        e.preventDefault();\n\n        const { accounts, returnContract } = this.state;\n\n        var carId = parseInt(id);\n\n        await returnContract.returnCar(carId, { from: accounts[0] })\n    }\n\n    render() {\n        return (\n            <div>\n                <div className=\"row\">\n                    <div className=\"col-xs-12 col-sm-8 col-sm-push-2\">\n                        <h1 className=\"text-center\">Car Rental</h1>\n                        <hr/>\n                        <br/>\n                    </div>\n                </div>\n\n                <div className=\"row\">\n                </div>\n\n                <div className=\"row\" id=\"carTemplate\">\n                    {this.state.cars.map(car =>\n                        <div className=\"col-md-4\">\n                            <form>\n                                <div className=\"card rounded\">\n                                    <div className=\"card-image\">\n                                        <span className=\"card-notify-badge\">{car.campaign}</span>\n                                        <span className=\"card-notify-year\">{car.year}</span>\n                                        <img className=\"img-fluid\" src={car.picture} alt={car.name}/>\n                                    </div>\n                                    <div className=\"card-image-overlay m-auto\">\n                                        <span className=\"card-detail-badge\">{car.seats}</span>\n                                        <span className=\"card-detail-badge\">{car.price}</span>\n                                        <span className=\"card-detail-badge\">{car.transmission}</span>\n                                    </div>\n                                    <div className=\"card-body text-center\">\n                                        <div className=\"ad-title m-auto\">\n                                            <h5>{car.name}</h5>\n                                        </div>\n                                        <button className=\"ad-btn\" type=\"button\" disabled={car.disabled} onClick={(e) => this.handleRent(car.id, e)}>Book</button>\n                                        <button className=\"ad-btn\" type=\"button\" onClick={(e) => this.handleReturn(car.id, e)}>Return</button>\n                                    </div>\n                                </div>\n                            </form>\n                        </div>\n                    )}\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default cars;"]},"metadata":{},"sourceType":"module"}